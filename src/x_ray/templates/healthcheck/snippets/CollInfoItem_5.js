const namespaces=[...new Set(data.map(a=>a.ns))],labels=[...new Set(data.map(a=>a.label))],latencyTypes=[{key:"readsLatency",name:"Reads",color:[54,162,235]},{key:"writesLatency",name:"Writes",color:[255,99,132]},{key:"commandsLatency",name:"Commands",color:[255,206,86]},{key:"transactionsLatency",name:"Transactions",color:[75,192,192]}],datasets=[];labels.forEach((a,e)=>{latencyTypes.forEach((t,s)=>{const n=namespaces.map(e=>{const s=data.find(t=>t.ns===e&&t.label===a);return s?s[t.key]:0});datasets.push({label:`${a} - ${t.name}`,data:n,backgroundColor:`rgba(${t.color[0]}, ${t.color[1]}, ${t.color[2]}, ${.8-.15*e})`,stack:"stack"+e})})});let wrapper=document.createElement("div"),canvas=document.createElement("canvas");wrapper.className="bar",canvas.className="bar",container.appendChild(wrapper),wrapper.appendChild(canvas);const ctx=canvas.getContext("2d"),chart=new Chart(ctx,{type:"bar",data:{labels:namespaces,datasets:datasets},options:{indexAxis:"y",scales:{x:{stacked:!0,title:{display:!0,text:"Latency (ms)"}},y:{stacked:!0,title:{display:!0,text:"Namespace"}}},plugins:{title:{display:!0,text:"Operation Latency by Namespace"},legend:{display:!0,position:"right"},tooltip:{callbacks:{label:function(a){return(a.dataset.label||"")+": "+(a.parsed.x||0).toFixed(2)+" ms"}}}}}});charts.push(chart);